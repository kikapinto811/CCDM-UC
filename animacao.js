const letters = {
    "+": [
        "imagens/letras/+/+ - cartoon.png",
        "imagens/letras/+/+ - cor amarela.png",
        "imagens/letras/+/+ - cor azul.png",
        "imagens/letras/+/+ - cor laranja.png",
        "imagens/letras/+/+ - cor verde.png",
        "imagens/letras/+/+ - pixel.png",
        "imagens/letras/+/+ - geometrico.png"
    ],

    "A": [
        "imagens/letras/a/a - cartoon.png",
        "imagens/letras/a/a - cor amarela.png",
        "imagens/letras/a/a - cor azul.png",
        "imagens/letras/a/a - cor laranja.png",
        "imagens/letras/a/a - cor verde.png",
        "imagens/letras/a/a - pixel.png",
        "imagens/letras/a/a - geometrico.png"
    ],

    "C": [
        "imagens/letras/c/c - cartoon.png",
        "imagens/letras/c/c - cor amarela.png",
        "imagens/letras/c/c - cor azul.png",
        "imagens/letras/c/c - cor laranja.png",
        "imagens/letras/c/c - cor verde.png",
        "imagens/letras/c/c - pixel.png",
        "imagens/letras/c/c - geometrico.png"
    ],

    "D": [
        "imagens/letras/D/D - cartoon.png",
        "imagens/letras/D/D - cor amarela.png",
        "imagens/letras/D/D - cor azul.png",
        "imagens/letras/D/D - cor laranja.png",
        "imagens/letras/D/D - cor verde.png",
        "imagens/letras/D/D - pixel.png",
        "imagens/letras/D/D - geometrico.png"
    ],

    "E": [
        "imagens/letras/e/e - cartoon.png",
        "imagens/letras/e/e - cor amarela.png",
        "imagens/letras/e/e - cor azul.png",
        "imagens/letras/e/e - cor laranja.png",
        "imagens/letras/e/e - cor verde.png",
        "imagens/letras/e/e - pixel.png",
        "imagens/letras/e/e - geometrico.png"
    ],

    "G": [
        "imagens/letras/G/G - cartoon.png",
        "imagens/letras/G/G - cor amarela.png",
        "imagens/letras/G/G - cor azul.png",
        "imagens/letras/G/G - cor laranja.png",
        "imagens/letras/G/G - cor verde.png",
        "imagens/letras/G/G - pixel.png",
        "imagens/letras/G/G - geometrico.png"
    ],

    "I": [
        "imagens/letras/i/i - cartoon.png",
        "imagens/letras/i/i - cor amarela.png",
        "imagens/letras/i/i - cor azul.png",
        "imagens/letras/i/i - cor laranja.png",
        "imagens/letras/i/i - cor verde.png",
        "imagens/letras/i/i - pixel.png",
        "imagens/letras/i/i - geometrico.png"
    ],

    "L": [
        "imagens/letras/L/L - cartoon.png",
        "imagens/letras/L/L - cor amarela.png",
        "imagens/letras/L/L - cor azul.png",
        "imagens/letras/L/L - cor laranja.png",
        "imagens/letras/L/L - cor verde.png",
        "imagens/letras/L/L - pixel.png",
        "imagens/letras/L/L - geometrico.png"
    ],

    "M": [
        "imagens/letras/M/M - cartoon.png",
        "imagens/letras/M/M - cor amarela.png",
        "imagens/letras/M/M - cor azul.png",
        "imagens/letras/M/M - cor laranja.png",
        "imagens/letras/M/M - cor verde.png",
        "imagens/letras/M/M - pixel.png",
        "imagens/letras/M/M - geometrico.png"
    ],

    "N": [
        "imagens/letras/n/n - cartoon.png",
        "imagens/letras/n/n - cor amarela.png",
        "imagens/letras/n/n - cor azul.png",
        "imagens/letras/n/n - cor laranja.png",
        "imagens/letras/n/n - cor verde.png",
        "imagens/letras/n/n - pixel.png",
        "imagens/letras/n/n - geometrico.png"
    ],

    "O": [
        "imagens/letras/o/o - cartoon.png",
        "imagens/letras/o/o - cor amarela.png",
        "imagens/letras/o/o - cor azul.png",
        "imagens/letras/o/o - cor laranja.png",
        "imagens/letras/o/o - cor verde.png",
        "imagens/letras/o/o - pixel.png",
        "imagens/letras/o/o - geometrico.png"
    ],

    "R": [
        "imagens/letras/r/r - cartoon.png",
        "imagens/letras/r/r - cor amarela.png",
        "imagens/letras/r/r - cor azul.png",
        "imagens/letras/r/r - cor laranja.png",
        "imagens/letras/r/r - cor verde.png",
        "imagens/letras/r/r - pixel.png",
        "imagens/letras/r/r - geometrico.png"
    ],

    "S": [
        "imagens/letras/s/s - cartoon.png",
        "imagens/letras/s/s - cor amarela.png",
        "imagens/letras/s/s - cor azul.png",
        "imagens/letras/s/s - cor laranja.png",
        "imagens/letras/s/s - cor verde.png",
        "imagens/letras/s/s - pixel.png",
        "imagens/letras/s/s - geometrico.png"
    ],
    
    "T": [
        "imagens/letras/T/T - cartoon.png",
        "imagens/letras/T/T - cor amarela.png",
        "imagens/letras/T/T - cor azul.png",
        "imagens/letras/T/T - cor laranja.png",
        "imagens/letras/T/T - cor verde.png",
        "imagens/letras/T/T - pixel.png",
        "imagens/letras/T/T - geometrico.png"
    ],

    "U": [
        "imagens/letras/U/U - cartoon.png",
        "imagens/letras/U/U - cor amarela.png",
        "imagens/letras/U/U - cor azul.png",
        "imagens/letras/U/U - cor laranja.png",
        "imagens/letras/U/U - cor verde.png",
        "imagens/letras/U/U - pixel.png",
        "imagens/letras/U/U - geometrico.png"
    ],

    "V": [
        "imagens/letras/v/v - cartoon.png",
        "imagens/letras/v/v - cor amarela.png",
        "imagens/letras/v/v - cor azul.png",
        "imagens/letras/v/v - cor laranja.png",
        "imagens/letras/v/v - cor verde.png",
        "imagens/letras/v/v - pixel.png",
        "imagens/letras/v/v - geometrico.png"
    ],

    "B": [
        "imagens/letras/B/B - cartoon.png",
        "imagens/letras/B/B - cor amarela.png",
        "imagens/letras/B/B - cor azul.png",
        "imagens/letras/B/B - cor laranja.png",
        "imagens/letras/B/B - cor verde.png",
        "imagens/letras/B/B - pixel.png",
        "imagens/letras/B/B - geometrico.png"
    ],

    "K": [
        "imagens/letras/K/K - cartoon.png",
        "imagens/letras/K/K - cor amarela.png",
        "imagens/letras/K/K - cor azul.png",
        "imagens/letras/K/K - cor laranja.png",
        "imagens/letras/K/K - cor verde.png",
        "imagens/letras/K/K - pixel.png",
        "imagens/letras/K/K - geometrico.png"
    ],

    "P": [
        "imagens/letras/P/P - cartoon.png",
        "imagens/letras/P/P - cor amarela.png",
        "imagens/letras/P/P - cor azul.png",
        "imagens/letras/P/P - cor laranja.png",
        "imagens/letras/P/P - cor verde.png",
        "imagens/letras/P/P - pixel.png",
        "imagens/letras/P/P - geometrico.png"
    ],

};

/* const audio = document.createElement('audio');
audio.src = "Tick - Sound Effect (HD).mp3";
document.body.appendChild(audio); */

function letra_final(letra) {
    /* definir constantes */
    const h_letra = window.innerHeight / 7;
    const w_letra = h_letra / 1.5;
    const vel = 5;
    /* criar canvas/ctx, definir tamanho, dar append ao html */
    const canvas = document.createElement('canvas');
    canvas.width = w_letra;
    canvas.height = h_letra;
    const ctx = canvas.getContext('2d');
    /* const spanContainer = document.getElementById('canvasContainer');
    spanContainer.appendChild(canvas); */
    /* definir resto das variaveis */
    let dir_atual; /* direçao de cima para baixo = true */
    if (Math.random() < 0.5) {
        dir_atual = true;
    } else {
        dir_atual = false;
    }
    let y_atual, y_prox;
    y_atual = 0;
    if (dir_atual === true) {
        y_prox = - h_letra;
    } else {
        y_prox = h_letra;
    }

    let animacao = false;
    let img_atual, img_prox;
    img_atual = new Image();
    let n = Math.floor(Math.random() * letters[letra].length);
    img_atual.src = letters[letra][n];
    img_atual.onload = function () {
        ctx.drawImage(img_atual, 0, y_atual, w_letra, h_letra);
    }

    n = Math.floor(Math.random() * letters[letra].length);
    img_prox = new Image();
    img_prox.src = letters[letra][n];

    function updateImagens() {
        img_atual = img_prox;
        let n;
        do {
            n = Math.floor(Math.random() * letters[letra].length);
        } while (letters[letra][n] === img_atual.src); // Make sure it's different
        /*     n = Math.floor(Math.random() * letters[letra].length);
            img_prox = letters[letra][n];
            while (img_prox == img_atual) {
                n = Math.floor(Math.random() * letters[letra].length);
                img_prox = letters[letra][n];
            } */
        img_prox.onload = function () {
            requestAnimationFrame(desenhaEAtualiza);
        };
        img_prox = new Image();
        img_prox.src = letters[letra][n];
    }

    function resetVariaveis() {
        if (Math.random() < 0.5) {
            dir_atual = true;
        } else {
            dir_atual = false;
        }
        y_atual = 0;
        if (dir_atual === true) {
            y_prox = - h_letra;
        } else {
            y_prox = h_letra;
        }
    }

    function checkAnimacaoFalse() {
        if (!animacao) {
            resetVariaveis();
            updateImagens();
        }
    }

    /* funçao para update e desenhar as imagens */
    function desenhaEAtualiza() {
        if (dir_atual) {
            if (y_atual < h_letra) {
                requestAnimationFrame(desenhaEAtualiza);
                animacao = true;
                y_atual += vel;
                y_prox += vel;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img_atual, 0, y_atual, w_letra, h_letra);
                ctx.drawImage(img_prox, 0, y_prox, w_letra, h_letra);
            } else {
                animacao = false;
                checkAnimacaoFalse();
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img_atual, 0, y_atual, w_letra, h_letra);
                ctx.drawImage(img_prox, 0, y_prox, w_letra, h_letra);
            }

        } else {
            if (y_atual > - h_letra) {
                requestAnimationFrame(desenhaEAtualiza);
                animacao = true;
                y_atual -= vel;
                y_prox -= vel;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img_atual, 0, y_atual, w_letra, h_letra);
                ctx.drawImage(img_prox, 0, y_prox, w_letra, h_letra);

            } else {
                animacao = false;
                checkAnimacaoFalse();
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img_atual, 0, y_atual, w_letra, h_letra);
                ctx.drawImage(img_prox, 0, y_prox, w_letra, h_letra);
            }
        }
    };

    /* funçao para ativaçao aleatoria da animaçao */
    function aleatorio(minTime, maxTime) {
        const randomTime = Math.floor(Math.random() * (maxTime - minTime + 1) + minTime);

        setTimeout(() => {
            /* audio.play(); */
            requestAnimationFrame(desenhaEAtualiza);
            aleatorio(minTime, maxTime);
        }, randomTime);
    }
    aleatorio(100, 10000);

    /* event listener para quando o mouse entra no canvas */
    canvas.addEventListener('mouseenter', function () {
        /* audio.play(); */
        requestAnimationFrame(desenhaEAtualiza);
        animacao = false;
    });

    return canvas;
}

function palavra_final(palavra, containerPalavra) {
    const h_letra = window.innerHeight / 6;
    const w_letra = h_letra / 1.5;
    let container = document.getElementById(containerPalavra);
    for (let i = 0; i < palavra.length; i++) {
        letra_final(palavra[i], w_letra, h_letra);
        let canvasLetra = letra_final(palavra[i]);
        container.appendChild(canvasLetra);
    }
}

palavra_final("CICLO", "containerCICLO");
palavra_final("DE", "containerDE");
palavra_final("CONVERSAS", "containerCONVERSAS");
palavra_final("DESIGN", "containerDESIGN");
palavra_final("+", "container+");
palavra_final("MULTIMEDIA", "containerMULTIMEDIA");
palavra_final("ABOUT", "containerABOUT");
palavra_final("SPEAKERS", "containerSPEAKERS");